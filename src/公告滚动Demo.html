<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>公告滚动示例 - 点击展开（修复版）</title>
  <style>
    body {
      font-family: "Microsoft YaHei", "微软雅黑", sans-serif;
      background: #f7f9fc;
      padding: 40px 20px;
      margin: 0;
      color: #333;
    }

    h2 {
      text-align: center;
      color: #2c3e50;
      font-weight: 500;
      margin-bottom: 30px;
    }

    /* 公告容器：Flex 布局，图标固定，文字区域弹性 */
    .marquee-container {
      width: 100%;
      max-width: 680px;
      margin: 0 auto;
      background: #fff8e6;
      border: 1px solid #ffd591;
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
      overflow: hidden;
      position: relative;
      cursor: pointer;
      user-select: none;
      display: flex;
      align-items: center;
      padding: 0 16px;
      transition: box-shadow 0.3s ease;
      height: 56px;
      gap: 10px; /* 推荐替代 margin-right */
    }

    .marquee-container:hover:not(.expanded) {
      box-shadow: 0 6px 16px rgba(0, 0, 0, 0.12);
    }

    /* 喇叭图标：固定尺寸，不参与布局压缩 */
    .marquee-icon {
      width: 28px;
      height: 28px;
      flex-shrink: 0;
      user-select: none;
      pointer-events: none;
      align-self: center;
    }

    /* 文字容器：占据剩余空间，内部内容滚动 */
    .marquee-text-wrapper {
      flex: 1;
      overflow: hidden;
      display: inline-block;
    }

    /* 滚动文字内容 */
    .marquee-content {
      white-space: nowrap;
      display: inline-block;
      font-size: 16px;
      color: #d48806;
      font-weight: 500;
      letter-spacing: 0.3px;
      animation: marquee 18s linear infinite;
      will-change: transform;
    }

    /* 悬停暂停（仅未展开时） */
    .marquee-container:hover:not(.expanded) .marquee-content {
      animation-play-state: paused;
    }

    /* 滚动动画 */
    @keyframes marquee {
      0% {
        transform: translateX(0);
      }
      100% {
        transform: translateX(-100%);
      }
    }

    /* 分隔符 */
    .marquee-content span.separator {
      margin: 0 16px;
      color: #ffd591;
      font-weight: bold;
    }

    /* 点击展开后：容器变高，取消滚动 */
    .marquee-container.expanded {
      height: auto;
      padding: 16px 20px;
      cursor: default;
      box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15);
      flex-wrap: wrap; /* 允许换行 */
      gap: 12px;
    }

    .marquee-container.expanded .marquee-text-wrapper {
      width: 100%; /* 占满一行 */
      overflow: visible;
    }

    .marquee-container.expanded .marquee-content {
      white-space: normal;
      animation: none;
      color: #ad6c00;
      font-weight: 600;
      text-align: left;
      display: block;
      transform: none !important;
    }

    /* 修复：移除 fade-out 动画，改为直接切换 */
    .marquee-content.fade-out {
      opacity: 1;
      transform: translateY(0);
    }
  </style>
</head>
<body>

  <h2>网站公告</h2>

  <div class="marquee-container" title="点击展开公告内容" role="region" aria-label="滚动公告栏" tabindex="0">
    <!-- 喇叭图标 -->
    <img src="assets/megaphone.svg" alt="公告喇叭图标" class="marquee-icon" aria-hidden="true" />

    <!-- 文字容器（独立控制滚动区域） -->
    <div class="marquee-text-wrapper">
      <div class="marquee-content" aria-live="polite" aria-atomic="true">
        <span>【重要通知】系统维护将于今晚12点开始，预计持续2小时，请合理安排使用时间。</span>
        <span class="separator">|</span>
        <span>【活动提醒】本月充值返利活动火热进行中，最高返现50%！</span>
        <span class="separator">|</span>
        <span>【温馨提示】请及时更新客户端，享受最新功能和体验。</span>
      </div>
    </div>
  </div>

  <script>
    const container = document.querySelector('.marquee-container');
    const content = container.querySelector('.marquee-content');

    container.addEventListener('click', () => {
      if (container.classList.contains('expanded')) {
        // 收起：直接移除 expanded 类
        container.classList.remove('expanded');
      } else {
        // 展开：先暂停动画，再立即切换状态，避免空白
        content.style.animationPlayState = 'paused';
        container.classList.add('expanded');
      }
    });

    // 键盘支持
    container.addEventListener('keydown', (e) => {
      if (e.key === 'Enter' || e.key === ' ') {
        e.preventDefault();
        container.click();
      }
    });
  </script>

</body>
</html>